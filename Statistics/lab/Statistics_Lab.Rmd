---
title: "Statistics Lab"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Part 1

1. Load the libraries needed in this lab. Read in the following child mortality data using `read_mortality()` function from `jhur` package. Assign it to `mort` variable. Change its first column name `X1` into `country`

https://jhudatascience.org/intro_to_r/data/mortality.csv
```{r}
library(tidyverse)
library(broom)
library(jhur)
library(psych)

mort = read_mortality()

# mort = mort %>% 
#   rename(???<new_name> = ???<old_name>)
```

2. Compute the correlation between the `1980`, `1990`, `2000`, and `2010` mortality variables.
(No need to save this in an object. Just display the result to the screen.) 

Hint: you can use `select()` function to first subset the data frame to keep the four columns only. Hint 2: to use column name in `select()` that starts with a number, surround it with back quotes. 

```{r}
# mort_sub = 
#   mort %>% 
#   ???

# cor(???)
# cor(???, use = ???)
```

3. BONUS. Compute the correlation between the `Myanmar`, `China`, and `United States` mortality data over the years. 

Note: column names are in 1st column of `mort` data frame.

```{r}
# make data frame that has data from the three countries only
# mort_sub_contry = mort %>% 
#   filter(??? %in% ???) 

# remove country column
# mortality_only <- 
#   mort_sub_contry %>%
#   select(???)

# transpose and rename 
mortality_only_transposed <- as.data.frame(t(mortality_only))
colnames(mortality_only_transposed) <- c( "China", "Myanmar", "United States")

# compute correlation matrix
# country_cor <- cor(???, use = ???)
# country_cor
```

# Part 2

1. Read in the Kaggle cars auction dataset from "http://jhudatascience.org/intro_to_r/data/kaggleCarAuction.csv" with the argument `col_types = cols(VehBCost = col_double())`:

```{r}
cars = read_csv("http://jhudatascience.org/intro_to_r/data/kaggleCarAuction.csv",
                col_types = cols(VehBCost = col_double()))

```

2. Fit a linear regression model with vehicle cost (`VehBCost`) as the outcome and 
vehicle age (`VehicleAge`) and whether it's an online sale (`IsOnlineSale`) as predictors.  

Save the model fit in an object called `lmfit_cars` and display the summary table.

```{r}
# lmfit_cars = lm(???, data = ???)
# summary(???)
```

3. Fit a linear regression model with vehicle cost (`VehBCost`) as the outcome predictors:  
vehicle age (`VehicleAge`), whether it's an online sale (`IsOnlineSale`), and interaction between `VehicleAge` and `IsOnlineSale`.

To specify interaction, use `VehicleAge * IsOnlineSale` in the formula. 

Save the model fit in an object called `lmfit_cars_2` and display the summary table.

```{r}
# lmfit_cars_2 = lm(???, data = ???)
# summary(???)
```


# Part 3

1. Fit a logistic regression model where the outcome is "bad buy" status and predictors are the cost (`VehBCost`) and vehicle age (`VehicleAge`).

Save the model fit in an object called `logfit_cars` and display the summary table.

Use `summary()` or `tidy(logfit_cars, conf.int = TRUE, exponentiate = TRUE)`
or `tidy(logfit_cars, conf.int = TRUE, exponentiate = FALSE)` for log odds ratios.  

```{r}
# logfit_cars = glm(???, data = ???, family = ???)
# summary(???)

# tidy(???, conf.int = TRUE, exponentiate = TRUE)
# tidy(???, conf.int = TRUE, exponentiate = FALSE)
```

2. Randomly sample `10,000` observations (rows) with replacement from the `cars` dataset and store this new dataset in an object called `cars_subsample`.  Hint: `sample_n` function

```{r}
set.seed(1)
cars_subsample = cars %>% 
  sample_n(size = 10000)
```

3. Fit the same logistic regression model as in problem 1. above  with this sample and display the summary. Call this model `logfit_cars_sub`. 

How do the results compare?  

```{r}
# logfit_cars_sub = glm(???, data = ???, 
#                       family = ???)

# summary(???)
# tidy(???, conf.int = TRUE, exponentiate = TRUE)
# tidy(???, conf.int = TRUE, exponentiate = FALSE)
```
