## -------------------------------------------------------------------------------------------------------------------
library(readr)
library(tidyverse)
library(dplyr)
library(lubridate)
library(jhur)
library(tidyverse)
library(broom)
library(naniar)

bike = read_csv(
  "http://jhudatascience.org/intro_to_r/data/Bike_Lanes.csv")



## -------------------------------------------------------------------------------------------------------------------
nrow(bike)
sum(complete.cases(bike))


## -------------------------------------------------------------------------------------------------------------------
namat = is.na(bike)
colSums(namat)


## -------------------------------------------------------------------------------------------------------------------
have_route = bike %>%  filter(!is.na(route))


## -------------------------------------------------------------------------------------------------------------------
naniar::gg_miss_var(bike)



## -------------------------------------------------------------------------------------------------------------------
naniar::pct_complete(bike$subType) #this or..
pull(bike, subType) %>% pct_complete() # this


## -------------------------------------------------------------------------------------------------------------------
BloodType <- tibble(gender = 
                    c("M", "Male", "Female", "F", "M", 
                      "Male", "F", "M", "F", "M", 
                      "F", "Man", "NA", "Man", "female"), 
                    type = c("A.-", "AB.+", "O.-", "O.+", "AB.-",
                               "B.+", "B.-", "o.-", "O.+", "A.-",
                              "A.+", "O.-", "B.-", "o.+", "AB.-"),
                    infection = c("Yes", "No", "Yes", "No", "No",
                                  "No", "Yes", "No", "Yes", "No",
                                  "No", "Yes", "Yes", "Yes", "Yes"))

BloodType


## -------------------------------------------------------------------------------------------------------------------
BloodType <- BloodType %>%
  mutate(gender = recode(gender, M = "Male", m = "Male", Man = "Male",
                                 F = "Female", female = "Female"))
BloodType


## -------------------------------------------------------------------------------------------------------------------
BloodType %>% pull(gender) %>% table(useNA = "ifany")


## -------------------------------------------------------------------------------------------------------------------
BloodType <- BloodType %>%
  mutate(type = recode(type, "o.-" = "O.-", "o.+" = "O.+"))
BloodType


## -------------------------------------------------------------------------------------------------------------------
BloodType %>% pull(type) %>% table(useNA = "ifany")


## -------------------------------------------------------------------------------------------------------------------
BloodType_split  <- BloodType %>% separate(type, into = c("blood_type", "Rhfactor"), sep = "\\.")


## -------------------------------------------------------------------------------------------------------------------
table(BloodType_split$Rhfactor) # base R
BloodType_split %>%pull(Rhfactor) %>% table() # tidyverse


## -------------------------------------------------------------------------------------------------------------------
BloodType_split %>%
  filter(blood_type == "O") %>%
  pull(infection) %>%
  table()


